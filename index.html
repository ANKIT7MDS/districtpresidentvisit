<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>प्रविष्टियाँ - कार्यक्रम विवरण</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans Devanagari', sans-serif;
      padding: 20px;
      background-color: #f9f9f9;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
      background-color: white;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: left;
      vertical-align: top;
    }
    th {
      background-color: #e3e3e3;
    }
    h2 {
      color: #333;
    }
  </style>
</head>
<body>
  <h2>प्रविष्टियाँ - कार्यक्रम विवरण</h2>
  <table id="responseTable">
    <thead id="thead"></thead>
    <tbody id="tbody"></tbody>
  </table>

  <script>
    const sheetURL = 'https://script.google.com/macros/s/AKfycbyXuM7Y2NTwnLU6j6LK48XkSi3X3zo2HMYF-2KguneVL_t_TgYQcskKy-Ly48oAWjNYMw/exec';

    fetch(sheetURL)
      .then(res => {
        if (!res.ok) throw new Error('Network response was not OK');
        return res.json();
      })
      .then(data => {
        const thead = document.getElementById('thead');
        const tbody = document.getElementById('tbody');

        if (data.length > 0) {
          // Table Headers
          let headerRow = '<tr>';
          Object.keys(data[0]).forEach(key => {
            headerRow += `<th>${key}</th>`;
          });
          headerRow += '</tr>';
          thead.innerHTML = headerRow;

          // Table Rows
          data.forEach(row => {
            let rowHTML = '<tr>';
            Object.values(row).forEach(val => {
              if (typeof val === 'string' && val.startsWith('http') && (val.includes('.jpg') || val.includes('.png'))) {
                rowHTML += `<td><img src="${val}" alt="फोटो" width="100"/></td>`;
              } else {
                rowHTML += `<td>${val}</td>`;
              }
            });
            rowHTML += '</tr>';
            tbody.innerHTML += rowHTML;
          });
        } else {
          tbody.innerHTML = '<tr><td colspan="10">कोई डेटा नहीं मिला</td></tr>';
        }
      })
      .catch(err => {
        document.getElementById('responseTable').innerHTML = '<tr><td colspan="10">डेटा लोड नहीं हो सका</td></tr>';
        console.error('त्रुटि:', err);
      });
  </script>
</body>
</html>
