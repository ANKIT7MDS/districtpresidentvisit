<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü‡§ø‡§Ø‡§æ‡§Å - ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§µ‡§ø‡§µ‡§∞‡§£</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans Devanagari', sans-serif;
      background-color: #f2f2f2;
      padding: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background-color: #fff;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      vertical-align: top;
    }
    th {
      background-color: #e0e0e0;
    }
    img {
      max-width: 100px;
    }
  </style>
</head>
<body>
  <h2>‡§™‡•ç‡§∞‡§µ‡§ø‡§∑‡•ç‡§ü‡§ø‡§Ø‡§æ‡§Å - ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∞‡§Æ ‡§µ‡§ø‡§µ‡§∞‡§£</h2>
  <table id="responseTable">
    <thead id="thead"></thead>
    <tbody id="tbody"></tbody>
  </table>

  <script>
    const sheetURL = https://script.google.com/macros/s/AKfycbyXuM7Y2NTwnLU6j6LK48XkSi3X3zo2HMYF-2KguneVL_t_TgYQcskKy-Ly48oAWjNYMw/exec';üëâ ‡§Ø‡§π‡§æ‡§Å Web App URL ‡§°‡§æ‡§≤‡•á‡§Ç';

    fetch(sheetURL)
      .then(response => {
        if (!response.ok) throw new Error("‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§Ö‡§∏‡§´‡§≤");
        return response.json();
      })
      .then(data => {
        const thead = document.getElementById('thead');
        const tbody = document.getElementById('tbody');

        if (data.error) {
          tbody.innerHTML = `<tr><td colspan="20">‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ${data.error}</td></tr>`;
          return;
        }

        if (data.length === 0) {
          tbody.innerHTML = "<tr><td colspan='20'>‡§ï‡•ã‡§à ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ</td></tr>";
          return;
        }

        // Headers
        let headerRow = '<tr>';
        Object.keys(data[0]).forEach(key => {
          headerRow += `<th>${key}</th>`;
        });
        headerRow += '</tr>';
        thead.innerHTML = headerRow;

        // Rows
        data.forEach(row => {
          let rowHTML = '<tr>';
          Object.values(row).forEach(val => {
            if (typeof val === 'string' && val.startsWith('http') && (val.includes('.jpg') || val.includes('.png'))) {
              rowHTML += `<td><img src="${val}" alt="‡§´‡§º‡•ã‡§ü‡•ã"></td>`;
            } else {
              rowHTML += `<td>${val}</td>`;
            }
          });
          rowHTML += '</tr>';
          tbody.innerHTML += rowHTML;
        });
      })
      .catch(error => {
        document.getElementById('responseTable').innerHTML = `<tr><td colspan="20">‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡§æ: ${error.message}</td></tr>`;
        console.error('Fetch Error:', error);
      });
  </script>
</body>
</html>
